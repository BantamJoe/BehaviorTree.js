{"version":3,"sources":["webpack:///webpack/universalModuleDefinition","webpack:///webpack/bootstrap abc028c16795565eca59","webpack:///./src/constants.js","webpack:///./src/BranchNode.js","webpack:///./src/Task.js","webpack:///./src/Node.js","webpack:///./src/index.js","webpack:///./src/Decorator.js","webpack:///./src/BehaviorTree.js","webpack:///./src/Selector.js","webpack:///./src/Sequence.js","webpack:///./src/Random.js"],"names":["RUNNING","Symbol","SUCCESS","FAILURE","BranchNode","blueprint","numNodes","nodes","length","blackboard","indexes","rerun","registryLookUp","x","start","overallResult","START_CASE","currentIndex","shift","node","result","run","OPT_OUT_CASE","end","Task","NOOP","Node","props","createDecorator","Selector","Sequence","Random","Decorator","decorator","config","runConfig","registry","lookedUpNode","Error","BehaviorTree","tree","lastResult","name","Math","floor","random"],"mappings":"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","file":"index.js","sourcesContent":["(function webpackUniversalModuleDefinition(root, factory) {\n\tif(typeof exports === 'object' && typeof module === 'object')\n\t\tmodule.exports = factory();\n\telse if(typeof define === 'function' && define.amd)\n\t\tdefine(\"behaviortree\", [], factory);\n\telse if(typeof exports === 'object')\n\t\texports[\"behaviortree\"] = factory();\n\telse\n\t\troot[\"behaviortree\"] = factory();\n})(typeof self !== 'undefined' ? self : this, function() {\nreturn \n\n\n// WEBPACK FOOTER //\n// webpack/universalModuleDefinition"," \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, {\n \t\t\t\tconfigurable: false,\n \t\t\t\tenumerable: true,\n \t\t\t\tget: getter\n \t\t\t});\n \t\t}\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = 4);\n\n\n\n// WEBPACK FOOTER //\n// webpack/bootstrap abc028c16795565eca59","export const RUNNING = Symbol('running')\nexport const SUCCESS = true\nexport const FAILURE = false\n\n\n\n// WEBPACK FOOTER //\n// ./src/constants.js","import { RUNNING } from './constants'\nimport Node from './Node'\n\nexport default class BranchNode extends Node {\n  constructor (blueprint) {\n    super(blueprint)\n\n    this.numNodes = blueprint.nodes.length\n  }\n\n  run (blackboard = null, { indexes = [], rerun, registryLookUp = x => x } = {}) {\n    this.blueprint.start(blackboard)\n    let overallResult = this.START_CASE\n    let currentIndex = indexes.shift() || 0\n    while (currentIndex < this.numNodes) {\n      let node = registryLookUp(this.blueprint.nodes[currentIndex])\n      const result = node.run(blackboard, { indexes, rerun })\n      if (result === RUNNING) {\n        return [ currentIndex, ...indexes ]\n      } else if (typeof result === 'object') { // array\n        return [ ...indexes, currentIndex, ...result ]\n      } else if (result === this.OPT_OUT_CASE) {\n        overallResult = result\n        break\n      } else {\n        ++currentIndex\n      }\n    }\n    this.blueprint.end(blackboard)\n    return overallResult\n  }\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/BranchNode.js","import Node from './Node'\n\nexport default class Task extends Node {}\n\n\n\n// WEBPACK FOOTER //\n// ./src/Task.js","import { RUNNING } from './constants'\n\nconst NOOP = () => {}\n\nexport default class Node {\n  constructor ({ run = NOOP, start = NOOP, end = NOOP, ...props }) {\n    this.blueprint = { run, start, end, ...props }\n  }\n\n  run (blackboard, { rerun = false } = {}) {\n    if (!rerun) this.blueprint.start(blackboard)\n    const result = this.blueprint.run(blackboard)\n    if (result !== RUNNING) {\n      this.blueprint.end(blackboard)\n    }\n    return result\n  }\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/Node.js","import BehaviorTree from './BehaviorTree'\nexport default BehaviorTree\n\nexport BranchNode from './BranchNode'\nexport Node from './Node'\nexport Selector from './Selector'\nexport Sequence from './Sequence'\nexport Random from './Random'\nexport Decorator, { createDecorator } from './Decorator'\nexport Task from './Task'\n\nexport { SUCCESS, FAILURE, RUNNING } from './constants'\n\n\n\n// WEBPACK FOOTER //\n// ./src/index.js","import Task from './Task'\n\n// export default function decorator (config) {\n//   return node => {\n//     return new Task({\n//       run (blackboard, runConfig) {\n//         return node.run(blackboard, runConfig)\n//       }\n//     })\n//   }\n// }\n\nexport function createDecorator (decorator) {\n  return (config) => {\n    return node => {\n      return new Task({\n        run (blackboard, runConfig) {\n          return decorator(() => node.run(blackboard, runConfig), blackboard, config)\n        }\n      })\n    }\n  }\n}\n\n/**\n * This decorator does nothing really, but demonstrates how a decorator works\n */\nexport default createDecorator(run => run())\n\n//\n//\n// class Decorator {\n//   constructor (config) {\n//     this.config = config\n//   }\n//\n//   apply (node) {\n//     return {\n//       run: (blackboard, runConfig) => {\n//         return node.run(blackboard, runConfig)\n//       }\n//     }\n//   }\n// }\n//\n// const InvertDecorator = createDecorator((run) => {\n//   const result = run()\n// })\n\n\n\n// WEBPACK FOOTER //\n// ./src/Decorator.js","import { RUNNING } from './constants'\nimport Task from './Task'\n\nlet registry = {}\n\nfunction registryLookUp (node) {\n  if (typeof node === 'string') {\n    const lookedUpNode = registry[node]\n    if (!lookedUpNode) {\n      throw new Error(`No node with name ${node} registered.`)\n    }\n    return lookedUpNode\n  }\n  return node\n}\n\nexport default class BehaviorTree {\n  constructor ({ tree, blackboard }) {\n    this.tree = tree\n    this.blackboard = blackboard\n    this.lastResult = null\n  }\n\n  step () {\n    const indexes = this.lastResult && typeof this.lastResult === 'object' ? this.lastResult : []\n    const rerun = this.lastResult === RUNNING || indexes.length > 0\n    this.lastResult = this.tree.run(this.blackboard, { indexes, rerun, registryLookUp })\n  }\n\n  static register (name, node) {\n    registry[name] = typeof node === 'function'\n      ? new Task({ run: node })\n      : node\n  }\n\n  static cleanRegistry () {\n    registry = {}\n  }\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/BehaviorTree.js","import { SUCCESS, FAILURE } from './constants'\nimport BranchNode from './BranchNode'\n\nexport default class Selector extends BranchNode {\n  constructor (blueprint) {\n    super(blueprint)\n\n    this.START_CASE = FAILURE\n    this.OPT_OUT_CASE = SUCCESS\n  }\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/Selector.js","import { SUCCESS, FAILURE } from './constants'\nimport BranchNode from './BranchNode'\n\nexport default class Selector extends BranchNode {\n  constructor (blueprint) {\n    super(blueprint)\n\n    this.START_CASE = SUCCESS\n    this.OPT_OUT_CASE = FAILURE\n  }\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/Sequence.js","import { RUNNING, SUCCESS, FAILURE } from './constants'\nimport BranchNode from './BranchNode'\n\nexport default class Random extends BranchNode {\n  run (blackboard = null, { indexes = [], rerun, registryLookUp = x => x } = {}) {\n    this.blueprint.start(blackboard)\n    let overallResult = this.START_CASE\n    let currentIndex = indexes.shift() || 0\n    if (!rerun) {\n      let currentIndex = Math.floor(Math.random() * this.numNodes)\n    }\n    const node = registryLookUp(this.blueprint.nodes[currentIndex])\n    const result = node.run(blackboard, { indexes, rerun })\n    if (result === RUNNING) {\n      return [ currentIndex, ...indexes ]\n    } else if (typeof result === 'object') { // array\n      return [ ...indexes, currentIndex, ...result ]\n    }\n    this.blueprint.end(blackboard)\n    return result\n  }\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/Random.js"],"sourceRoot":""}